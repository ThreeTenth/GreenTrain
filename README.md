# GreenTrain
绿皮车，一个随机匿名的喜好匹配的限时聊天APP

## 实现

基于 [go-chat-example](https://github.com/excing/go-chat-example) 
的一个示例，在此基础上，实现了用户组的概念，并为具有相同喜好的用户进行匹配，重新编写了 Web 页面。

匹配成功后，获得一定的聊天时长，当时间到了，则自动解除组关系。

## 匹配规则

### 前提

- **喜欢的**: 用户的喜好、爱好、兴趣等
- **不喜欢的**: 用户的所不喜欢的、讨厌的
- **开场白**：当系统自动发送给潜在用户的留言
- **第一、二、三优选列表**：优先级依次递减，处于列表中的用户均有可能是潜在用户
- **空闲队列**：表示该队列中的用户处于空闲状态
- **邀请**：当潜在用户被随机选中时，系统将代替用户进行邀请

### 规则

1. 如果当前空闲用户只是用户本人，则等待他人发起邀请
2. 搜索空闲队列，遇到已受到他人邀请的用户，则忽略
3. 如果对方没有喜好，则进入第三优选列表
4. 查看与对方的共同喜欢的事物的数量（A），以及自己不喜欢的而对方喜欢的事物的数量（B），当 `A < B` 时，则忽略
5. 当 `5 <= A` 时，对方进入第一优选列表
6. 当 `3 <= A` 时，对方进入第二优选列表
7. 当 A 低于 3 时，对方进入第三优选列表
8. 之后依次在三个列表中随机选择一名用户，当这名用户在线时，向对方发起邀请
9. 邀请内容为用户的开场白，如果没有，则发送 `Hi~`

## 编译 Linux 平台的可执行程序

```
set GOARCH=amd64
set GOOS=linux
packr2
go build --ldflags="-w -s" -o "greentrain"
upx -9 greentrain
packr2 clean
echo "finished"
```

## 使用

为 `greentrain` 添加可执行权限，再使用 `./greentrain` 命令即可，比如

```
chmod 775 greentrain
./greentrain
```
